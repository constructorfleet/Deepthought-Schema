$schema: "https://json-schema.org/draft/07/schema"
$id: "https://teagantotally.rocks/deepthought/meta/constant"
title: Constant schema validating meta-schema

definitions:
  fieldTypes:
    enum:
      - array
      - boolean
      - integer
      - number
      - string

  valueSchema:
    allOf:
      - if:
          properties:
            dataType:
              const: boolean
        then:
          properties:
            value:
              oneOf:
                - const: true
                - const: false
          required:
            - value
      - if:
          properties:
            dataType:
              const: integer
        then:
          properties:
            value:
              type: integer
          required:
            - value
      - if:
          properties:
            dataType:
              const: number
        then:
          properties:
            value:
              type: number
          required:
            - value
      - if:
          properties:
            dataType:
              const: string
        then:
          properties:
            value:
              type: string
          required:
            - value
      - if:
          properties:
            dataType:
              const: array
        then:
          properties:
            value:
              type: array
              items:
                $ref: "#"
          required:
            - value

  constantSchema:
    allOf:
      - $ref: "#/definitions/valueSchema"
      - properties:
          dataType:
            $ref: "#/definitions/fieldTypes"
          name:
            type: string
            minLength: 1
            pattern: "^[A-Z][a-zA-Z ]+$"
          description:
            type: string
            minLength: 1
          unit:
            type: string
            minLength: 1
            pattern: "^[a-z_]+$"

        required:
          - dataType
          - name
          - description
          - unit
          - value

allOf:
  - properties:
      id:
        type: string
        minLength: 1
        pattern: "^[a-z][a-z_]+[a-z]$"
      examples:
        type: array
        items:
          type: object
          $ref: "#/definitions/constantSchema"
      dataType:
        $ref: "#/definitions/fieldTypes"
      name:
        type: string
        minLength: 1
        pattern: "^[A-Z][a-zA-Z ]+$"
      description:
        type: string
        minLength: 1
      unit:
        type: string
        minLength: 1
        pattern: "^[a-z_]+$"
  - $ref: "#/definitions/valueSchema"

required:
  - dataType
  - name
  - description
  - unit
  - value

type:
  - object
  - boolean
default: true