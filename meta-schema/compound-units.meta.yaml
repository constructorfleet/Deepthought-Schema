$schema: "https://json-schema.org/draft/07/schema"
$id: "https://teagantotally.rocks/deepthought/meta/compoundunit"
title: Compound Unit schema validating meta-schema

type:
  - object
  - boolean
definitions:
  labelSchema:
    type: object
    properties:
      single:
        type: string
        minLength: 1
      plural:
        type: string
        minLength: 1
      symbol:
        type: string
        minLength: 1
    required:
      - single
      - plural
      - symbol

  conversionSchema:
    type: object
    properties:
      unit:
        type: string
        minLength: 1
        pattern: "^[a-z_]+$"
      conversion:
        type: number
        format: float
    required:
      - unit
      - conversion

  unitIdentifierSchema:
    type: string
    pattern: "[a-z][a-z_]+"

  exponentSchema:
    properties:
      exponent:
        type: number
    required:
      - exponent

  unitGroupSchema:
    properties:
      group:
        $ref: "#/definitions/unitSchema"
      exponent:
        type: number
    required:
      - group
  unitSchema:
    properties:
      unit:
        $ref: "#/definitions/unitIdentifierSchema"
      exponent:
        type: number
      multipliedBy:
        oneOf:
          - $ref: "#/definitions/unitSchema"
          - $ref: "#/definitions/unitGroupSchema"
      dividedBy:
        oneOf:
          - $ref: "#/definitions/unitSchema"
          - $ref: "#/definitions/unitGroupSchema"
    required:
      - unit
properties:
  id:
    type: string
    minLength: 1
    pattern: "^[a-z][a-z_]+[a-z]$"
  name:
    type: string
    minLength: 1
    pattern: "^[A-Z][a-zA-Z ]+$"
  description:
    type: string
    minLength: 1
  label:
    $ref: "#/definitions/labelSchema"
  conversion:
    $ref: "#/definitions/conversionSchema"
  unit:
    oneOf:
      - $ref: "#/definitions/unitIdentifierSchema"
      - $ref: "#/definitions/unitSchema"
      - $ref: "#/definitions/unitGroupSchema"
required:
  - id
  - name
  - description
  - label
  - unit
default: true